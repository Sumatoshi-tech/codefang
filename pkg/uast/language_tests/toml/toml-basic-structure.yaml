language: toml
tests:
  - name: "Root is File"
    code: |
      name = "John"
    query: rfilter(.type == "File") |> map(.type)
    expected:
      - "File"

  - name: "Key-value pair is KeyValue"
    code: |
      name = "John"
    query: rfilter(.type == "KeyValue") |> map(.type)
    expected:
      - "KeyValue"

  - name: "KeyValue has Key and Value roles"
    code: |
      name = "John"
    query: rfilter(.type == "KeyValue") |> map(.roles)
    expected:
      - ["Key", "Value"]

  - name: "Key is Identifier with Name role"
    code: |
      name = "John"
    query: rfilter(.type == "Identifier" and .token == "name") |> map(.roles)
    expected:
      - ["Name"]

  - name: "String value is Literal"
    code: |
      name = "John"
    query: rfilter(.type == "Literal" and .token contains "John") |> map(.type)
    expected:
      - "Literal"

  - name: "Integer value is Literal"
    code: |
      age = 30
    query: rfilter(.type == "Literal" and .token == "30") |> map(.type)
    expected:
      - "Literal"

  - name: "Boolean true is Literal"
    code: |
      enabled = true
    query: rfilter(.type == "Literal" and .token == "true") |> map(.type)
    expected:
      - "Literal"

  - name: "Boolean false is Literal"
    code: |
      disabled = false
    query: rfilter(.type == "Literal" and .token == "false") |> map(.type)
    expected:
      - "Literal"

  - name: "Float value is Literal"
    code: |
      pi = 3.14159
    query: rfilter(.type == "Literal" and .token == "3.14159") |> map(.type)
    expected:
      - "Literal"

  - name: "Multiple key-values parsed"
    code: |
      name = "John"
      age = 30
    query: rfilter(.type == "KeyValue") |> map(.type)
    expected:
      - "KeyValue"
      - "KeyValue"
